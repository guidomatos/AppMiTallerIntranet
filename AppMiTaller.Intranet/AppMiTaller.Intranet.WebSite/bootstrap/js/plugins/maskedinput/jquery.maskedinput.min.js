!function(e){var t,n=function(){var e=document.createElement("input"),t="onpaste";return e.setAttribute(t,""),"function"==typeof e[t]?"paste":"input"}()+".mask",a=navigator.userAgent,r=/iphone/i.test(a),i=/android/i.test(a);e.mask={definitions:{9:"[0-9]",a:"[A-Za-z]","*":"[A-Za-z0-9]"},dataName:"rawMaskFn",placeholder:"_"},e.fn.extend({caret:function(e,t){var n;if(0!==this.length&&!this.is(":hidden"))return"number"==typeof e?(t="number"==typeof t?t:e,this.each(function(){this.setSelectionRange?this.setSelectionRange(e,t):this.createTextRange&&((n=this.createTextRange()).collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select())})):(this[0].setSelectionRange?(e=this[0].selectionStart,t=this[0].selectionEnd):document.selection&&document.selection.createRange&&(n=document.selection.createRange(),e=0-n.duplicate().moveStart("character",-1e5),t=e+n.text.length),{begin:e,end:t})},unmask:function(){return this.trigger("unmask")},mask:function(a,o){var c,l,s,u,f;return!a&&this.length>0?e(this[0]).data(e.mask.dataName)():(o=e.extend({placeholder:e.mask.placeholder,completed:null},o),c=e.mask.definitions,l=[],s=f=a.length,u=null,e.each(a.split(""),function(e,t){"?"==t?(f--,s=e):c[t]?(l.push(RegExp(c[t])),null===u&&(u=l.length-1)):l.push(null)}),this.trigger("unmask").each(function(){function h(e){for(;f>++e&&!l[e];);return e}function d(e){for(;--e>=0&&!l[e];);return e}function m(e,t){var n,a;if(!(0>e)){for(n=e,a=h(t);f>n;n++)if(l[n]){if(!(f>a&&l[n].test(y[a])))break;y[n]=y[a],y[a]=o.placeholder,a=h(a)}v(),b.caret(Math.max(u,e))}}function p(e){var t,n,a,r;for(t=e,n=o.placeholder;f>t;t++)if(l[t]){if(a=h(t),r=y[t],y[t]=n,!(f>a&&l[a].test(r)))break;n=r}}function g(e,t){var n;for(n=e;t>n&&f>n;n++)l[n]&&(y[n]=o.placeholder)}function v(){b.val(y.join(""))}function k(e){var t,n,a=b.val(),r=-1;for(t=0,pos=0;f>t;t++)if(l[t]){for(y[t]=o.placeholder;pos++<a.length;)if(n=a.charAt(pos-1),l[t].test(n)){y[t]=n,r=t;break}if(pos>a.length)break}else y[t]===a.charAt(pos)&&t!==s&&(pos++,r=t);return e?v():s>r+1?(b.val(""),g(0,f)):(v(),b.val(b.val().substring(0,r+1))),s?t:u}var b=e(this),y=e.map(a.split(""),function(e){return"?"!=e?c[e]?o.placeholder:e:void 0}),x=b.val();b.data(e.mask.dataName,function(){return e.map(y,function(e,t){return l[t]&&e!=o.placeholder?e:null}).join("")}),b.attr("readonly")||b.one("unmask",function(){b.unbind(".mask").removeData(e.mask.dataName)}).bind("focus.mask",function(){clearTimeout(t);var e;x=b.val(),e=k(),t=setTimeout(function(){v(),e==a.length?b.caret(0,e):b.caret(e)},10)}).bind("blur.mask",function(){k(),b.val()!=x&&b.change()}).bind("keydown.mask",function(e){var t,n,a,i=e.which;8===i||46===i||r&&127===i?(t=b.caret(),n=t.begin,0==(a=t.end)-n&&(n=46!==i?d(n):a=h(n-1),a=46===i?h(a):a),g(n,a),m(n,a-1),e.preventDefault()):27==i&&(b.val(x),b.caret(0,k()),e.preventDefault())}).bind("keypress.mask",function(t){var n,a,r,c=t.which,s=b.caret();t.ctrlKey||t.altKey||t.metaKey||32>c||c&&(0!=s.end-s.begin&&(g(s.begin,s.end),m(s.begin,s.end-1)),n=h(s.begin-1),f>n&&(a=String.fromCharCode(c),l[n].test(a)&&(p(n),y[n]=a,v(),r=h(n),i?setTimeout(e.proxy(e.fn.caret,b,r),0):b.caret(r),o.completed&&r>=f&&o.completed.call(b))),t.preventDefault())}).bind(n,function(){setTimeout(function(){var e=k(!0);b.caret(e),o.completed&&e==b.val().length&&o.completed.call(b)},0)}),k()}))}})}(jQuery);